name: 'Dependencies'
description: 'Install dependencies from lockfile'

inputs:
  compiler:
    description: 'Compiler to use'
    required: false
    default: ''
  GITHUB_TOKEN:
    description: 'Secrets to pass to the action'
    required: false
    default: ''

runs:
  using: 'composite'
  steps:
    - name: Prerequisites
      if: startsWith(inputs.os, 'macos')
      shell: bash
      run: |
        brew install ninja ccache

    - name: Install dependencies
      shell: run
      env:
        GITHUB_TOKEN: ${{ inputs.GITHUB_TOKEN }}
      run: |
        if [ -n "${{ inputs.compiler }}" ]; then
          CI/dependencies/setup.sh -c "${{ inputs.compiler }}"
        else
          CI/dependencies/setup.sh
        fi
